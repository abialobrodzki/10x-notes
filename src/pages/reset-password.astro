---
import Layout from "@/layouts/Layout.astro";
import ResetPasswordPage from "@/components/ResetPasswordPage";

// Disable prerendering for dynamic URL parameter validation
export const prerender = false;

// Server-side validation of token and type parameters
const url = new URL(Astro.request.url);
const token = url.searchParams.get("token");
const type = url.searchParams.get("type");

// Redirect to forgot-password with error if token is missing or invalid
if (!token || type !== "recovery") {
  return Astro.redirect("/forgot-password?error=invalid_token");
}
---

<Layout title="Ustawianie nowego hasÅ‚a - 10xNotes">
  <ResetPasswordPage token={token} client:load />
</Layout>
